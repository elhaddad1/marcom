function GetUserItems() { jQuery.ajax({ cache: false, type: "GET", async: false, url: "/clsWebService/AddtocardList", dataType: "text", success: function (e) { LoadUserItems(e); CalculateAmount(); jQuery(".Remove").bind("click", function () { var e = this.getAttribute("ItemID"); jQuery.getJSON("/clsWebService/AddtocardDelete?ProductId=" + e, function (e) { GetUserItems() }).fail(function () { console.log("error") }) }) }, error: function (e, t, n) { } }) } function GetItemsCount() { jQuery.getJSON("/clsWebService/AddtocardAmount", function (e) { jQuery("#Itemcount").text("" + e + ""); jQuery("#itemcount1").text("" + e + "") }).fail(function () { console.log("error") }) } function CalculateAmountEvent(e) { var t = jQuery(e).parent().parent().parent().parent().parent().parent().attr("id"); var n = jQuery(e).val(); jQuery.getJSON("/clsWebService/ChangeProductAmount?CrdId=" + t + "&amount=" + n + "", function (e) { if (e != "error") { var t = 0; if (jQuery(".Quantity") != null) { jQuery(".Quantity").each(function () { t = parseFloat(t) + parseFloat(jQuery(this).val()) }) } jQuery("#Itemcount").text("" + t + ""); jQuery("#itemcount1").text("" + t + "") } }).fail(function () { console.log("error") }) } function CalculateAmount() { var e = 0; if (jQuery(".Quantity") != null) { jQuery(".Quantity").each(function () { e = parseFloat(e) + parseFloat(jQuery(this).val()) }) } jQuery("#Itemcount").text("" + e + ""); jQuery("#itemcount1").text("" + e + "") } function LoadUserItems(e) { jQuery("#wrapertd").html(e) } function AddNewItem(e, t) { jQuery.getJSON("/clsWebService/AddtocardAddProduct?ProductId=" + e + "", function (e) { if (e != "error") { GetUserItems() } }).fail(function () { console.log("error") }) } function DrowItem(e, t) { var n = jQuery(document.getElementById("" + e + "")); if (n.length == 0) { var r = "<div id='" + e + "' class='item_wraper'>" + " <table class='one_item_table' border='0' cellpadding='0' cellspacing='0'>" + "<tr>" + "<td>" + "<div class='ItemName_div'> " + t + "</div>" + "</td>" + "<td>" + "<div class='Item_count_div'>" + "<input id='Text_" + e + "' value='1' class='Quantity' />" + "</div>" + "</td>" + "<td>" + "<a class='Remove' id='Remove" + e + "' ItemID='" + e + "'></a>" + "</td>" + "</tr>" + "</table></div>"; jQuery("#wrapertd").prepend(r) } else { var i = jQuery(document.getElementById("Text_" + e + "")).val(); i++; jQuery(document.getElementById("Text_" + e + "")).val("" + i + "") } jQuery(".Remove").unbind("click"); jQuery(".Remove").bind("click", function () { var e = this.getAttribute("ItemID"); jQuery.getJSON("/clsWebService/AddtocardDelete?ProductId=" + e, function (e) { GetUserItems() }).fail(function () { console.log("error") }) }) } function CheckOutUserItems() { var e = []; var t = []; jQuery("#wrapertd").children("div").each(function (n) { var r = jQuery(this).attr("id"); var i = jQuery("#Text_" + r + ""); e.push(r); t.push(i.val()) }); var n = jQuery("#CommentText").val(); if (e.length > 0) { jQuery.ajax({ url: "/clsWebService/AddtocardArCheckout", type: "POST", contentType: "application/json; charset=utf-8", data: JSON.stringify({ arrayId: e, arrayQuamtity: t, CommentText: n }), success: function (e) { jQuery("#wrapertd").html(""); jQuery("#messagewrapper").html('<div class="messagebox success"></div>'); jQuery("#messagewrapper .messagebox").text("طلب الشراء تم بنجاح ، برجاء مراجعة بريدك الالكترونى"); displayMessages(); CalculateAmount() } }) } else { jQuery("#messagewrapper").html('<div class="messagebox warning"></div>'); jQuery("#messagewrapper .messagebox").text("برجاء أضافة منتجات للقائمة أولا"); displayMessages(); CalculateAmount() } } jQuery.noConflict(); jQuery(document).ready(function () { jQuery("#Cart").hide(); jQuery("#Cartcomment").hide(); jQuery("#Items").click(function () { jQuery("#Cart").slideToggle(1500) }); jQuery("#Close_Cart").click(function () { jQuery("#Cart").slideToggle(1500) }); jQuery(".cart").click(function () { var e = this.getAttribute("ItemID"); var t = this.getAttribute("ItemName"); AddNewItem(e, t) }); jQuery("#CheckOut").bind("click", function () { var e = jQuery("#Itemcount").text(); e = parseInt(e); if (e == 0) { jQuery("#messagewrapper").html('<div class="messagebox success"></div>'); jQuery("#messagewrapper .messagebox").text("أضف منتجات للقائمةأولا"); displayMessages() } else { jQuery("#Cart").hide(); jQuery("#Cartcomment").show(); jQuery("#CommentText").val("") } }); jQuery("#BacktoCart").bind("click", function () { jQuery("#Cart").show(); jQuery("#Cartcomment").hide() }); jQuery("#ConfirmCart").bind("click", function () { CheckOutUserItems(); jQuery("#Cartcomment").hide(); jQuery("#Cart").show() }); GetUserItems() })