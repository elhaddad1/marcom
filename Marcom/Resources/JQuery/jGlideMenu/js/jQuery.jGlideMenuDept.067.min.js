jQuery.jGlideMenuDept = { useDropShadow: new Boolean, useDragDrop: new Boolean, defaultScrollSpeed: new Number(0), defaultScrollBackSpeed: new Number(0), slideRight: new Boolean, useSmoothScrolling: new Boolean, easeFx: new String(""), closeLinkMarkUp: new String(""), menuShowFx: new String(""), menuHideFx: new String(""), tileWidth: new Number(0), tileInset: new Number(0), itemsToDisplay: new Number(8), useTileURL: new Boolean, tileSource: new String(""), URLParams: new Object, loadImage: new String(""), loadImageStyle: new Object, initialTile: new String(""), alertOnError: new Boolean, captureLinks: new Boolean, imagePath: new String, tileCount: new Number(0), animation: new Boolean, helperImage: new Boolean, currentElement: new Object, currentElementID: new String(""), hasDragDropSupport: new Boolean, hasShadowSupport: new Boolean, displayToggle: new Boolean, tileScrollPosition: new Array, smoothScrollTimer: new Array, mouseHover: new Boolean, demoMode: new Boolean, initialize: function (e) { return this.each(function () { jQuery.jGlideMenuDept.animation = false; jQuery.jGlideMenuDept.helperImage = false; jQuery.jGlideMenuDept.hasDragDropSupport = false; jQuery.jGlideMenuDept.hasShadowSupport = false; jQuery.jGlideMenuDept.tileCount = 0; jQuery.jGlideMenuDept.displayToggle = false; jQuery.jGlideMenuDept.mouseHover = false; jQuery.jGlideMenuDept.demoMode = false; jQuery.jGlideMenuDept.currentElement = jQuery(this); if (this.id) jQuery.jGlideMenuDept.currentElementID = this.id; var t = { itemsToDisplay: 12, tileInset: 7, tileWidth: 300, useDropShadow: false, slideRight: true, useDragDrop: true, useSmoothScrolling: true, useTileURL: false, defaultScrollSpeed: 750, defaultScrollBackSpeed: 800, tileSource: "myTiles", URLParams: {}, closeLinkMarkUp: "Close", menuShowFx: "fadeIn", menuHideFx: "fadeOut", easeFx: "linear", loadImage: "../../Resources/JQuery/jGlideMenu/img/ajax.gif", initialTile: "tile_011", alertOnError: false, captureLinks: true, loadImageStyle: { position: "absolute", bottom: "10px", left: "10px", "z-index": "999" }, imagePath: "../../Resources/JQuery/jGlideMenu/img/", demoMode: false }; if (e) jQuery.extend(t, e); jQuery.jGlideMenuDept.checkFeatures(); if (t.closeLinkMarkUp.length < 1) t.closeLinkMarkUp = "x Close"; if (parseInt(t.itemsToDisplay) < 1) t.itemsToDisplay = 1; if (t.initialTile.length < 0) jQuery.jGlideMenuDept.errorTrap("Invalid Configuration"); for (i in t) jQuery.jGlideMenuDept[i] = t[i]; if (jQuery.jGlideMenuDept.useTileURL == false && jQuery.jGlideMenuDept.tileSource.length > 0) { jQuery(jQuery.jGlideMenuDept.tileSource).css("display", "none"); jQuery(jQuery.jGlideMenuDept.currentElement).children().not(jQuery.jGlideMenuDept.tileSource).remove() } else jQuery(jQuery.jGlideMenuDept.currentElement).html(""); jQuery(jQuery.jGlideMenuDept.currentElement).append('<div class="jGMDept_wrapper" id="jGMDept_wrapper_' + this.id + '"></div>'); var n = document.createElement("img"); n.src = jQuery.jGlideMenuDept.loadImage; n.style.display = "none"; n.id = "jGMDept_helper" + jQuery.jGlideMenuDept.currentElementID; jQuery(jQuery.jGlideMenuDept.currentElement).append(n); jQuery("img#" + n.id).css(jQuery.jGlideMenuDept.loadImageStyle); jQuery.jGlideMenuDept.helperImage = true; if (jQuery.jGlideMenuDept.hasDragDropSupport == true && jQuery.jGlideMenuDept.useDragDrop == true) { if (jQuery.isFunction(jQuery("body").Draggable)) jQuery(this).Draggable({ handle: ".jGMDept_header" }); else jQuery(this).draggable({ handle: ".jGMDept_header" }) } if (jQuery.jGlideMenuDept.hasShadowSupport == true && jQuery.jGlideMenuDept.useDropShadow == true) { if (jQuery.isFunction(jQuery("body").dropShadow)) jQuery(this).dropShadow(); else jQuery(this).shadow({ color: "#cccccc" }) } jQuery(jQuery.jGlideMenuDept.currentElement).find("div.jGMDept_header a").bind("click", function () { if (jQuery.jGlideMenuDept.displayToggle == true) return false; jQuery.jGlideMenuDept.toggleDisplay(true); return false }); jQuery(this).hover(function () { jQuery.jGlideMenuDept.mouseHover = true }, function () { jQuery.jGlideMenuDept.mouseHover = false }); jQuery(document).keydown(function (e) { return true; var t = e.charCode ? e.charCode : e.keyCode ? e.keyCode : 0; if (t == 32 && jQuery.jGlideMenuDept.mouseHover == false) { jQuery.jGlideMenuDept.toggleDisplay(); return } if (jQuery.jGlideMenuDept.mouseHover == false) return false; switch (t) { case 37: break; case 38: break; case 39: break; case 40: break; case 13: break; case 32: jQuery.jGlideMenuDept.toggleDisplay(); return; break } }); jQuery.jGlideMenuDept.loadTile(jQuery.jGlideMenuDept.initialTile, jQuery.jGlideMenuDept.URLParams) }) }, toggleDisplay: function (e) { jQuery.jGlideMenuDept.displayToggle = true; jQuery.jGlideMenuDept.mouseHover == false; if (jQuery(jQuery.jGlideMenuDept.currentElement).css("display") == "block") var t = 0; else var t = 1; jQuery(jQuery.jGlideMenuDept.currentElement).animate({ opacity: t }, "slow", function () { if (e == true) { jQuery.jGlideMenuDept.scrollToTile(0, jQuery.jGlideMenuDept.defaultScrollBackSpeed); jQuery.jGlideMenuDept.tileScrollPosition[0] = 0 } if (t > 0) jQuery(this).css("display", "block"); else jQuery(this).css("display", "none"); jQuery.jGlideMenuDept.displayToggle = false }) }, checkFeatures: function () { jQuery.jGlideMenuDept.hasDragDropSupport = jQuery.isFunction(jQuery("body").Draggable); if (jQuery.jGlideMenuDept.hasDragDropSupport == false) jQuery.jGlideMenuDept.hasDragDropSupport = jQuery.isFunction(jQuery("body").draggable); jQuery.jGlideMenuDept.hasShadowSupport = jQuery.isFunction(jQuery("body").dropShadow); if (jQuery.jGlideMenuDept.hasShadowSupport == false) jQuery.jGlideMenuDept.hasShadowSupport = jQuery.isFunction(jQuery("body").shadow); return }, parseURL: function (e) { if (!jQuery.browser.msie) { return e } if (e.indexOf("#tile_") < 0) { return e } var t = e.split("#"); return "#" + t[t.length - 1] }, countTiles: function () { jQuery.jGlideMenuDept.tileCount = parseInt(jQuery("div.jGMDept_tile").size()) }, loadTile: function (e, t) { var n = document.createElement("div"); var r = jQuery.jGlideMenuDept.tileCount + 1; n.id = "jGMDept_tile_" + jQuery.jGlideMenuDept.currentElementID + "_" + r; if (jQuery.jGlideMenuDept.slideRight == true) var i = jQuery.jGlideMenuDept.tileWidth * jQuery.jGlideMenuDept.tileCount + jQuery.jGlideMenuDept.tileInset; else var i = jQuery.jGlideMenuDept.tileWidth * jQuery.jGlideMenuDept.tileCount * -1 + jQuery.jGlideMenuDept.tileInset; jQuery("#jGMDept_wrapper_" + jQuery.jGlideMenuDept.currentElementID).append(n); jQuery("#" + n.id).addClass("jGMDept_tile").css({ top: 0, left: i + "px", width: "300px", position: "absolute", overflow: "hidden", margin: 0, padding: 0, border: 0, display: "block" }); var s = '<div style="height:100%;margin:0;border:0;width:100%;padding:0;text-align:center;">' + "<h3>Missing Tile</h3><p>Unable to locate the requested Tile</p></div>"; if (jQuery.jGlideMenuDept.useTileURL == false) { if (jQuery("ul#" + e).size() < 1) { jQuery.jGlideMenuDept.errorTrap("Invalid Tile Request"); return false } var o = jQuery("ul#" + e).attr("title"); var u = jQuery("ul#" + e).attr("alt"); var a = jQuery("ul#" + e + " li").size(); var f = []; jQuery("ul#" + e + " li").each(function () { if (jQuery("a", this).size() > 0) f[f.length] = [jQuery("a", this).attr("href"), jQuery("a", this).text(), 1]; else f[f.length] = [jQuery(this).attr("rel"), jQuery(this).text(), 0] }); var s = jQuery.jGlideMenuDept.buildTile(o, u, f) } else { if (jQuery.jGlideMenuDept.tileSource.length < 1) { jQuery.jGlideMenuDept.errorTrap("Invalid AJAX Request"); return false } var l = "img#jGMDept_helper" + jQuery.jGlideMenuDept.currentElementID; jQuery(l).ajaxStart(function () { jQuery(this).animate({ opacity: "show" }, "fast") }).ajaxStop(function () { jQuery(this).animate({ opacity: "hide" }, "slow") }); t.tile = e; jQuery.ajax({ type: "POST", url: jQuery.jGlideMenuDept.tileSource, data: t, async: false, success: function (n) { jQuery("body").append('<div id="jGMDept_temp_' + jQuery.jGlideMenuDept.currentElementID + t.tile + '" style="display:none;">' + n + "</div>"); if (jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile + " ul#" + e).size() < 1) { jQuery.jGlideMenuDept.errorTrap("AJAX: Invalid Tile Request"); return false } var r = jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile + " ul#" + e).attr("title"); var i = jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile + " ul#" + e).attr("alt"); var o = jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile + " ul#" + e + " li").size(); var u = []; jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile + " ul#" + e + " li").each(function () { if (jQuery("a", this).size() > 0) u[u.length] = [jQuery("a", this).attr("href"), jQuery("a", this).text(), 1]; else u[u.length] = [jQuery(this).attr("rel"), jQuery(this).text(), 0] }); jQuery("#jGMDept_temp_" + jQuery.jGlideMenuDept.currentElementID + t.tile).remove(); s = jQuery.jGlideMenuDept.buildTile(r, i, u); jQuery(l).ajaxStart(function () { }).ajaxStop(function () { }) }, error: function (e) { jQuery.jGlideMenuDept.errorTrap("Invalid AJAX Tile Request"); jQuery(l).ajaxStart(function () { }).ajaxStop(function () { }) } }) } jQuery("#" + n.id).html(s); jQuery("#" + n.id + " div.jGMDept_content a").bind("click", function () { var e = ""; e = jQuery.jGlideMenuDept.parseURL(jQuery(this).attr("href")); if (e.length < 1) { return false } if (e.substr(0, 1) == "#") { if (jQuery.jGlideMenuDept.animation == true) return false; var t = e.substr(1, e.length - 1); jQuery.jGlideMenuDept.loadTile(t, jQuery.jGlideMenuDept.URLParams); return false } else { if (jQuery.jGlideMenuDept.demoMode) { alert("Navigation Requestion: " + e) } else { window.location.href = e } if (jQuery.jGlideMenuDept.captureLinks == true) return false } return true }); jQuery.jGlideMenuDept.countTiles(); if (jQuery.jGlideMenuDept.tileCount > 1) { jQuery("#" + n.id).append('<div class="jGMDept_back"><a href="#">&laquo; Back</a></div>'); jQuery("#" + n.id + " div.jGMDept_back").bind("click", function () { if (jQuery.jGlideMenuDept.animation == true) return false; jQuery.jGlideMenuDept.scrollToTile(r - 1, jQuery.jGlideMenuDept.defaultScrollBackSpeed); return false }); if (jQuery.jGlideMenuDept.tileCount > 2) { jQuery("#" + n.id).append('<div class="jGMDept_reset"><a href="#">&laquo; Home</a></div>'); jQuery("#" + n.id + " div.jGMDept_reset").bind("click", function () { if (jQuery.jGlideMenuDept.animation == true) return false; jQuery.jGlideMenuDept.scrollToTile(1, jQuery.jGlideMenuDept.defaultScrollBackSpeed); return false }) } } jQuery.jGlideMenuDept.tileScrollPosition[r] = 0; jQuery.jGlideMenuDept.drawPagers(n.id, jQuery("#" + n.id + " .jGMDept_content a").size()); if (jQuery.jGlideMenuDept.useSmoothScrolling == false) { jQuery("#" + n.id + " .jGMDept_pager a").click(function () { var e = 1; if (jQuery(this).attr("rel") == "Up") e = 0; jQuery.jGlideMenuDept.scrollItems(e) }) } else { jQuery("#" + n.id + " .jGMDept_pager a").hover(function () { var e = 1; if (jQuery(this).attr("rel") == "Up") e = 0; jQuery.jGlideMenuDept.smoothScrollTimer[jQuery.jGlideMenuDept.tileCount] = window.setInterval("jQuery.jGlideMenuDept.scrollItems(" + e + ")", 250) }, function () { window.clearInterval(jQuery.jGlideMenuDept.smoothScrollTimer[jQuery.jGlideMenuDept.tileCount]) }) } jQuery.jGlideMenuDept.scrollToTile(r, jQuery.jGlideMenuDept.defaultScrollSpeed) }, scrollItems: function (e) { var t = "#jGMDept_tile_" + jQuery.jGlideMenuDept.currentElementID + "_" + jQuery.jGlideMenuDept.tileCount; var n = jQuery(t + " .jGMDept_content a"); var r = jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount]; if (r <= 0 && e == 0) return; if (r + jQuery.jGlideMenuDept.itemsToDisplay - 2 >= jQuery(n).size() && e == 1) return; if (e == 0) jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount]--; else jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount]++; jQuery(n).show(); jQuery(t + " .jGMDept_content").children("a:lt(" + jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount] + ")").hide(); jQuery.jGlideMenuDept.drawPagers(t.substr(1, t.length), jQuery(n).size()) }, drawPagers: function (e, t) { jQuery("#" + e + " .jGMDept_pager").find("a").each(function () { if (jQuery(this).attr("rel") == "Up") { if (jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount] > 0) jQuery(this).css("display", "block"); else jQuery(this).css("display", "none") } else { if (jQuery.jGlideMenuDept.tileScrollPosition[jQuery.jGlideMenuDept.tileCount] + jQuery.jGlideMenuDept.itemsToDisplay - 2 < jQuery("#" + e + " .jGMDept_content a").size()) jQuery(this).css("display", "block"); else jQuery(this).css("display", "none") } }) }, cleanTiles: function (e) { var t = e + 1; var n = jQuery.jGlideMenuDept.tileCount; if (e >= n) return false; for (var r = t; r <= n; r++) { jQuery("#jGMDept_tile_" + jQuery.jGlideMenuDept.currentElementID + "_" + r).remove(); jQuery.jGlideMenuDept.tileScrollPosition[r] = 0 } jQuery.jGlideMenuDept.countTiles(); return }, scrollToTile: function (e, t) { jQuery.jGlideMenuDept.countTiles(); var n = jQuery.jGlideMenuDept.tileCount; if (e > n) e = n; if (e < 1) e = 1; if (!t) t = jQuery.jGlideMenuDept.defaultScrollSpeed; var r = jQuery.jGlideMenuDept.tileWidth * e - jQuery.jGlideMenuDept.tileWidth; var i = jQuery.jGlideMenuDept.slideRight == true ? r * -1 : r; jQuery.jGlideMenuDept.animation = true; jQuery("div#jGMDept_wrapper_" + jQuery.jGlideMenuDept.currentElementID).animate({ left: i }, t, jQuery.jGlideMenuDept.easeFx, function () { if (e < n) jQuery.jGlideMenuDept.cleanTiles(e); if (i != 0) i += "px"; jQuery(this).css({ left: i }); jQuery.jGlideMenuDept.animation = false }) }, buildTile: function (e, t, n) { if (jQuery.jGlideMenuDept.imagePath.length > 1 && jQuery.jGlideMenuDept.imagePath.substr(-1, 1) != "/") jQuery.jGlideMenuDept.imagePath += "/"; var r = new String(""); r = '<div class="jGMDept_cats"><img src=' + e + '><p class="jGMDept_desc">' + t + "</p></div>"; r += '<div class="jGMDept_pager"><a href="#" rel="Up" title="Scroll Up" style="display:none"><span>More</span></a></div>'; r += '<div class="jGMDept_content">'; for (var i = 0; i < n.length; i++) { var s = n[i][2] == 1 ? "" : "#"; var o = n[i][2] == 1 ? "" : ' class="jGMDept_more"'; r += '<a href="' + s + n[i][0] + '"' + o + ">" + n[i][1] + "</a>" } r += "</div>"; r += '<div class="jGMDept_pager"><a href="#" rel="Down" title="Scroll Down" style="display:none"><span>More</span></a></div>'; return r }, errorTrap: function (e) { if (jQuery.jGlideMenuDept.alertOnError == true) alert(e); return } }; jQuery.fn.jGlideMenuDept = jQuery.jGlideMenuDept.initialize; jQuery.fn.jGlideMenuDeptToggle = jQuery.jGlideMenuDept.toggleDisplay; jQuery.fn.reverseDept = function () { return this.pushStack(this.get().reverse(), arguments) }